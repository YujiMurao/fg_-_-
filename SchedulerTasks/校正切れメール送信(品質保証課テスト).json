{
  "Description": "毎月一回\r\n品質保証課（Z)",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.ServerCommands.Models.MonthlyAndDaysOfMonthScheduleTrigger, ServerDesignerCommon",
      "DaysOfMonth": [
        1
      ],
      "Months": [
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9,
        10,
        11,
        12
      ],
      "StartDateTime": 45239.375,
      "ScheduleRunInDebugServer": false
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "担当者メアド",
      "TableValue": {
        "TableName": "mst_insptool_management_department",
        "BindingInfos": [
          {
            "BindingInfo": {
              "TableName": "mst_insptool_management_department",
              "ColumnName": "supervisor",
              "AttachType": {
                "$type": "ForguncyDataAccess.UserColumnAttachObj, ForguncyDataAccess",
                "UserColumnAttachType": 2
              }
            },
            "ColumnName": "supervisor"
          },
          {
            "BindingInfo": {
              "TableName": "mst_insptool_management_department",
              "ColumnName": "leader",
              "AttachType": {
                "$type": "ForguncyDataAccess.UserColumnAttachObj, ForguncyDataAccess",
                "UserColumnAttachType": 2
              }
            },
            "ColumnName": "leader"
          },
          {
            "BindingInfo": {
              "TableName": "mst_insptool_management_department",
              "ColumnName": "staff1",
              "AttachType": {
                "$type": "ForguncyDataAccess.UserColumnAttachObj, ForguncyDataAccess",
                "UserColumnAttachType": 2
              }
            },
            "ColumnName": "staff1"
          },
          {
            "BindingInfo": {
              "TableName": "mst_insptool_management_department",
              "ColumnName": "staff2",
              "AttachType": {
                "$type": "ForguncyDataAccess.UserColumnAttachObj, ForguncyDataAccess",
                "UserColumnAttachType": 2
              }
            },
            "ColumnName": "staff2"
          },
          {
            "BindingInfo": {
              "TableName": "mst_insptool_management_department",
              "ColumnName": "staff3",
              "AttachType": {
                "$type": "ForguncyDataAccess.UserColumnAttachObj, ForguncyDataAccess",
                "UserColumnAttachType": 2
              }
            },
            "ColumnName": "staff3"
          },
          {
            "BindingInfo": {
              "TableName": "mst_insptool_management_department",
              "ColumnName": "staff4",
              "AttachType": {
                "$type": "ForguncyDataAccess.UserColumnAttachObj, ForguncyDataAccess",
                "UserColumnAttachType": 2
              }
            },
            "ColumnName": "staff4"
          },
          {
            "BindingInfo": {
              "TableName": "mst_insptool_management_department",
              "ColumnName": "staff5",
              "AttachType": {
                "$type": "ForguncyDataAccess.UserColumnAttachObj, ForguncyDataAccess",
                "UserColumnAttachType": 2
              }
            },
            "ColumnName": "staff5"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
          "ColumnBindingInfo": {
            "TableName": "mst_insptool_management_department",
            "ColumnName": "code"
          },
          "Value": "Z"
        }
      },
      "ID": "6f0f55c1db454b90926727f005e354b0"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-1)+1,\"yyyy/m\")"
      },
      "ID": "2e108d6a984a4e2da8bae519547c7537"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月初日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-1)+1,\"yyyy/m/d\")"
      },
      "ID": "f4fd7210434d473da5bfaa7f900645ea"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月末日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),0),\"yyyy/m/d\")"
      },
      "ID": "0da19885bb104f3eb97865cb4b59f5d5"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "先月初日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-2)+1,\"yyyy/m/d\")"
      },
      "ID": "83ca52f2c18b4de2860230ba70a38722"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "先月末日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-1),\"yyyy/m/d\")"
      },
      "ID": "6fac5debb37b4ab89ad461d49c449b68"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月校正数",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "TableValueType": 3,
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "Condition1": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "Condition1": {
              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
              "Condition1": {
                "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                "Condition1": {
                  "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                  "Condition1": {
                    "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                    "Condition1": {
                      "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                      "Condition1": {
                        "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                        "Condition1": {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "CompareType": 3,
                          "ColumnBindingInfo": {
                            "TableName": "trn_insptool_tools",
                            "ColumnName": "next_caribration_ymd"
                          },
                          "Value": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=今月初日"
                          }
                        },
                        "Condition2": {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "CompareType": 5,
                          "ColumnBindingInfo": {
                            "TableName": "trn_insptool_tools",
                            "ColumnName": "next_caribration_ymd"
                          },
                          "Value": {
                            "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                            "SerializeProperty": "=今月末日"
                          }
                        }
                      },
                      "Condition2": {
                        "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                        "Condition1": {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "trn_insptool_tools",
                            "ColumnName": "category"
                          },
                          "Value": "社内",
                          "LeftBracket": 1
                        },
                        "Condition2": {
                          "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                          "ColumnBindingInfo": {
                            "TableName": "trn_insptool_tools",
                            "ColumnName": "category"
                          },
                          "Value": "社外",
                          "RightBracket": 1
                        },
                        "RelationType": 1
                      }
                    },
                    "Condition2": {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "CompareType": 1,
                      "ColumnBindingInfo": {
                        "TableName": "trn_insptool_tools",
                        "ColumnName": "prohibition_reason"
                      },
                      "Value": "廃棄"
                    }
                  },
                  "Condition2": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "CompareType": 1,
                    "ColumnBindingInfo": {
                      "TableName": "trn_insptool_tools",
                      "ColumnName": "prohibition_reason"
                    },
                    "Value": "故障"
                  }
                },
                "Condition2": {
                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                  "CompareType": 1,
                  "ColumnBindingInfo": {
                    "TableName": "trn_insptool_tools",
                    "ColumnName": "prohibition_reason"
                  },
                  "Value": "紛失"
                }
              },
              "Condition2": {
                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                "CompareType": 1,
                "ColumnBindingInfo": {
                  "TableName": "trn_insptool_tools",
                  "ColumnName": "prohibition_reason"
                },
                "Value": "移管"
              }
            },
            "Condition2": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason"
              },
              "Value": "不適合"
            }
          },
          "Condition2": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "Condition1": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "code"
                }
              },
              "Value": "Q",
              "LeftBracket": 1
            },
            "Condition2": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "code"
                }
              },
              "Value": "E",
              "RightBracket": 1
            },
            "RelationType": 1
          }
        }
      },
      "ID": "7043f627d318420992607f531221a772",
      "Comments": "校正月の案内用"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月期限数",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "TableValueType": 3,
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "Condition1": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "Condition1": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 3,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "kouseiyuukoukigenymd"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=今月初日"
              }
            },
            "Condition2": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 5,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "kouseiyuukoukigenymd"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=今月末日"
              }
            }
          },
          "Condition2": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "Condition1": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "code"
                }
              },
              "Value": "Q",
              "LeftBracket": 1
            },
            "Condition2": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "code"
                }
              },
              "Value": "E",
              "RightBracket": 1
            },
            "RelationType": 1
          }
        }
      },
      "ID": "290158851bf04e419621238b2796328e",
      "Comments": "有効期限が切れる案内"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "校正切れ数",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "TableValueType": 3,
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "Condition1": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "Condition1": {
              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
              "Condition1": {
                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                "CompareType": 5,
                "ColumnBindingInfo": {
                  "TableName": "trn_insptool_tools",
                  "ColumnName": "kouseiyuukoukigenymd"
                },
                "Value": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=先月末日"
                }
              },
              "Condition2": {
                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                "CompareType": 1,
                "ColumnBindingInfo": {
                  "TableName": "trn_insptool_tools",
                  "ColumnName": "usage"
                },
                "Value": "使用禁止"
              }
            },
            "Condition2": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "category"
              },
              "Value": "非校正"
            }
          },
          "Condition2": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "Condition1": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "code"
                }
              },
              "Value": "Q",
              "LeftBracket": 1
            },
            "Condition2": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "name"
                }
              },
              "Value": "E",
              "RightBracket": 1
            },
            "RelationType": 1
          }
        }
      },
      "ID": "97530611a70f435c952ccd23063b8af3",
      "Comments": "校正切れの案内用"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "校正切れ数機器リスト",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "BindingInfos": [
          {
            "BindingInfo": {
              "TableName": "trn_insptool_tools",
              "ColumnName": "ctrl_no"
            },
            "ColumnName": "管理番号"
          }
        ],
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "Condition1": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "Condition1": {
              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
              "Condition1": {
                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                "CompareType": 3,
                "ColumnBindingInfo": {
                  "TableName": "trn_insptool_tools",
                  "ColumnName": "kouseiyuukoukigenymd"
                },
                "Value": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=先月初日"
                }
              },
              "Condition2": {
                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                "CompareType": 5,
                "ColumnBindingInfo": {
                  "TableName": "trn_insptool_tools",
                  "ColumnName": "kouseiyuukoukigenymd"
                },
                "Value": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=先月末日"
                }
              }
            },
            "Condition2": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "category"
              },
              "Value": "非校正"
            }
          },
          "Condition2": {
            "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
            "CompareType": 1,
            "ColumnBindingInfo": {
              "TableName": "trn_insptool_tools",
              "ColumnName": "usage"
            },
            "Value": "使用禁止"
          }
        }
      },
      "ID": "aab65c1e70964db9a0fb49f287af5ed0",
      "Comments": "校正切れの案内用"
    },
    {
      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
      "ConditionAndCommandPairList": [
        {
          "Condition": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "Condition1": {
              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
              "Condition1": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=今月校正数"
                  }
                },
                "value": "0",
                "compareType": 2
              },
              "Condition2": {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=今月期限数"
                  }
                },
                "value": "0",
                "compareType": 2
              },
              "RelationType": 1
            },
            "Condition2": {
              "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
              "param": {
                "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                "ParamObject": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=校正切れ数"
                }
              },
              "value": "0",
              "compareType": 2
            },
            "RelationType": 1
          },
          "CommandList": [
            {
              "$type": "Forguncy.Model.SendMailCommand, ServerDesignerCommon",
              "From": "equipment@rorze.com",
              "Subject": "校正測定機器の期限について",
              "Content": "品質保証課　担当者 さま\r\n\r\nForguncy計測機器タスクからの自動送信メールです。([=今月])\r\n①今月の校正対象測定機器は[=今月校正数]件あります。\r\n[%PageNavigate=(今月校正対象機器リスト,こちらをクリック)%]\r\n②今月の校正有効期限が切れる測定機器は[=今月期限数]件あります。\r\n[%PageNavigate=(今月校正有効期限機器リスト,こちらをクリック)%]\r\n③校正有効期限が切れた測定機器は[=校正切れ数]件あります。\r\n[%PageNavigate=(先月校正有効期限機器リスト,こちらをクリック)%]\r\n\r\n以上\r\n",
              "EnhancedRecipient": {
                "CommonValue": {
                  "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                  "SerializeProperty": "=担当者メアド"
                }
              },
              "EnhancedBCC": {
                "CommonValue": "murao.yuji@rorze.com"
              },
              "Priority": "high",
              "ID": "ccf7093a78304f08aca03fc62dc324c4"
            }
          ],
          "ID": "ba58e08f-39ad-4ffc-9a2f-d25f097f5a82"
        }
      ]
    }
  ],
  "Name": "校正切れメール送信(品質保証課テスト)"
}