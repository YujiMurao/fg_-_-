{
  "Name": "校正切れメール送信(国内営業課)",
  "Description": "毎月一回\r\n国内営業課(Y)",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.MonthlyAndDaysOfMonthScheduleTriggerSaveData, ServerDesignerCommon",
      "DaysOfMonth": [
        1
      ],
      "Months": [
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9,
        10,
        11,
        12
      ],
      "StartDateTime": 45566.333333333336,
      "ScheduleRunInDebugServer": false
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-1)+1,\"yyyy/m\")"
      },
      "ID": "783dd3a15a454b79bb2e800cebc8a12e"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月初日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-1)+1,\"yyyy/m/d\")"
      },
      "ID": "fc076e09621948f9a40f49d75504361c"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月末日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),0),\"yyyy/m/d\")"
      },
      "ID": "e2ef2cfe547e46cf99056c36b7e4361b"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "先月初日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-2)+1,\"yyyy/m/d\")"
      },
      "ID": "f683439917e2484a96d22d9ec0cea50a"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "先月末日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-1),\"yyyy/m/d\")"
      },
      "ID": "1af86bbba633453c9917f399da035f18"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月校正数",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "TableValueType": 3,
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "SubConditions": [
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 3,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "next_caribration_ymd",
                "GUID": "0d424b51-fee2-44b0-921a-b78dce313035"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=今月初日"
              }
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 5,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "next_caribration_ymd",
                "GUID": "be322457-cdb7-4a36-bb5d-120bf8977e6b"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=今月末日"
              }
            },
            {
              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
              "SubConditions": [
                {
                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                  "ColumnBindingInfo": {
                    "TableName": "trn_insptool_tools",
                    "ColumnName": "category",
                    "GUID": "3a5fa3ee-ef46-4d1e-b604-39df8d50dbfa"
                  },
                  "Value": "社内",
                  "LeftBracket": 1
                },
                {
                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                  "ColumnBindingInfo": {
                    "TableName": "trn_insptool_tools",
                    "ColumnName": "category",
                    "GUID": "b94d4490-ac26-4e7d-88b1-06784a140b68"
                  },
                  "Value": "社外",
                  "RightBracket": 1
                }
              ],
              "RelationType": 1
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason",
                "GUID": "c092e58a-e99a-48e0-868b-31ecbc63937a"
              },
              "Value": "廃棄"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason",
                "GUID": "591e827c-107f-4af7-81d8-98ac44ae5a82"
              },
              "Value": "故障"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason",
                "GUID": "b890528f-6104-4988-8b08-cbdacc41a4bc"
              },
              "Value": "紛失"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason",
                "GUID": "274b6801-d067-41c5-a8c3-2caf13ff6cd7"
              },
              "Value": "移管"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason",
                "GUID": "011e1b9c-d353-4815-a709-0e11ae0f4a34"
              },
              "Value": "不適合"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "GUID": "b094867e-ac89-4815-9c80-0299b86f1c13",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "code"
                }
              },
              "Value": "Y"
            }
          ]
        }
      },
      "ID": "df0155344a48476bb97f14d2c870584d",
      "Comments": "校正月の案内用"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月期限数",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "TableValueType": 3,
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "SubConditions": [
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 3,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "kouseiyuukoukigenymd",
                "GUID": "6b73aaf6-55e3-4fea-8301-296639755609"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=今月初日"
              }
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 5,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "kouseiyuukoukigenymd",
                "GUID": "8f8ed43a-f2a9-4778-96e9-90201b6aa892"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=今月末日"
              }
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "GUID": "9bb18b4b-26f1-4db8-b46c-b684796cf8fc",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "code"
                }
              },
              "Value": "Y"
            }
          ]
        }
      },
      "ID": "133b6f8953c64930b66c9a044e02e78e",
      "Comments": "有効期限が切れる案内"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "校正切れ数",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "TableValueType": 3,
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "SubConditions": [
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 5,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "kouseiyuukoukigenymd",
                "GUID": "5e7c25e2-6180-49e1-bddf-fbe872d3795e"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=先月末日"
              }
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "usage",
                "GUID": "c9278b19-745e-430c-a8ff-2f70b281b9ff"
              },
              "Value": "使用禁止"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "category",
                "GUID": "cfdfc26f-561e-4ba9-ab86-8b105ec22de7"
              },
              "Value": "非校正"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "GUID": "b2031fab-e525-4369-9bf2-fdac6b085453",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "code"
                }
              },
              "Value": "Y"
            }
          ]
        }
      },
      "ID": "7a4441a495204633afadf645ba82665a",
      "Comments": "校正切れの案内用"
    },
    {
      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
      "ConditionAndCommandPairList": [
        {
          "Condition": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "SubConditions": [
              {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=今月校正数"
                  }
                },
                "value": "0",
                "compareType": 2
              },
              {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=今月期限数"
                  }
                },
                "value": "0",
                "compareType": 2
              },
              {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=校正切れ数"
                  }
                },
                "value": "0",
                "compareType": 2
              }
            ],
            "RelationType": 1
          },
          "CommandList": [
            {
              "$type": "Forguncy.Model.SendMailCommand, ServerDesignerCommon",
              "From": "equipment@rorze.com",
              "EnhancedRecipient": {
                "TableName": "mst_insptool_personincharge",
                "TableColumn": {
                  "TableName": "mst_insptool_personincharge",
                  "ColumnName": "chart_in_person",
                  "GUID": "3035b102-a8f5-43da-9317-5202cb6e7fcb",
                  "AttachType": {
                    "$type": "ForguncyDataAccess.UserColumnAttachObj, ForguncyDataAccess",
                    "UserColumnAttachType": 2
                  }
                },
                "QueryCondition": {
                  "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                  "SubConditions": [
                    {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "mst_insptool_personincharge",
                        "ColumnName": "ctrl_id",
                        "GUID": "ca10fd2b-f804-495d-8f25-3b2c1bb3d66a",
                        "RelationBinding": {
                          "RelatedTable": "mst_insptool_management_department",
                          "RelatedColumn": "ID",
                          "DisplayColumn": "code"
                        }
                      },
                      "Value": "Y"
                    },
                    {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "mst_insptool_personincharge",
                        "ColumnName": "contact",
                        "GUID": "4a9c1f25-b394-4e40-a14e-9c5b2b206c53"
                      },
                      "Value": "1"
                    }
                  ]
                },
                "IsMultiRecipient": true
              },
              "Subject": "校正測定機器の期限について",
              "Content": "国内営業課　担当者 さま\r\n\r\nForguncy計測機器タスクからの自動送信メールです。([=今月])\r\n①今月の校正対象測定機器は[=今月校正数]件あります。\r\n[%PageNavigate=(今月校正対象機器リスト,こちらをクリック)%]\r\n②今月の校正有効期限が切れる測定機器は[=今月期限数]件あります。\r\n[%PageNavigate=(今月校正有効期限機器リスト,こちらをクリック)%]\r\n③校正有効期限が切れた測定機器は[=校正切れ数]件あります。\r\n[%PageNavigate=(先月校正有効期限機器リスト,こちらをクリック)%]\r\n\r\n以上\r\n",
              "EnhancedBCC": {
                "CommonValue": "murao.yuji@rorze.com,qa-kousei@rorze.com"
              },
              "Priority": "high",
              "ID": "52d019c493064e2ba070d0e654abcbea"
            }
          ],
          "ID": "f03a0bb6-5c6b-4c46-965e-f1777dcdf367"
        }
      ]
    }
  ]
}