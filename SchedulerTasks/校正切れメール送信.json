{
  "Description": "毎月一回",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.ServerCommands.Models.DailyScheduleTrigger, ServerDesignerCommon",
      "StartDateTime": 45231.375,
      "ScheduleRunInDebugServer": false
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月社内校正数",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "TableValueType": 3,
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "Condition1": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "Condition1": {
              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
              "Condition1": {
                "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                "Condition1": {
                  "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                  "Condition1": {
                    "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                    "Condition1": {
                      "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                      "Condition1": {
                        "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                        "CompareType": 3,
                        "ColumnBindingInfo": {
                          "TableName": "trn_insptool_tools",
                          "ColumnName": "next_caribration_ymd"
                        },
                        "Value": {
                          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                          "SerializeProperty": " =DATE(YEAR(TODAY()),MONTH(TODAY()),1)"
                        }
                      },
                      "Condition2": {
                        "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                        "CompareType": 5,
                        "ColumnBindingInfo": {
                          "TableName": "trn_insptool_tools",
                          "ColumnName": "next_caribration_ymd"
                        },
                        "Value": {
                          "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                          "SerializeProperty": " =EOMONTH(TODAY(),0)"
                        }
                      }
                    },
                    "Condition2": {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "trn_insptool_tools",
                        "ColumnName": "category"
                      },
                      "Value": "社内"
                    }
                  },
                  "Condition2": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "CompareType": 1,
                    "ColumnBindingInfo": {
                      "TableName": "trn_insptool_tools",
                      "ColumnName": "prohibition_reason"
                    },
                    "Value": "廃棄"
                  }
                },
                "Condition2": {
                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                  "CompareType": 1,
                  "ColumnBindingInfo": {
                    "TableName": "trn_insptool_tools",
                    "ColumnName": "prohibition_reason"
                  },
                  "Value": "故障"
                }
              },
              "Condition2": {
                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                "CompareType": 1,
                "ColumnBindingInfo": {
                  "TableName": "trn_insptool_tools",
                  "ColumnName": "prohibition_reason"
                },
                "Value": "紛失"
              }
            },
            "Condition2": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason"
              },
              "Value": "移管"
            }
          },
          "Condition2": {
            "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
            "CompareType": 1,
            "ColumnBindingInfo": {
              "TableName": "trn_insptool_tools",
              "ColumnName": "prohibition_reason"
            },
            "Value": "不適合"
          }
        }
      },
      "ID": "3a3a6a3e978a4d70a8e6a9c0d9e4e962",
      "Disabled": true
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "月初め",
      "ParameterValue": "{Day(Now())}",
      "ID": "8ac01feb019945908ec0c7cd0c63160d"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "月末",
      "ParameterValue": " EOMONTH(TODAY(),0)",
      "ID": "78c938a6bf964064b2c3039d4f34b0ca"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月社内校正数",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "TableValueType": 3,
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "Condition1": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "Condition1": {
              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
              "Condition1": {
                "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                "Condition1": {
                  "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                  "Condition1": {
                    "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                    "Condition1": {
                      "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                      "Condition1": {
                        "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                        "ColumnBindingInfo": {
                          "TableName": "trn_insptool_tools",
                          "ColumnName": "category"
                        },
                        "Value": "社内"
                      },
                      "Condition2": {
                        "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                        "CompareType": 1,
                        "ColumnBindingInfo": {
                          "TableName": "trn_insptool_tools",
                          "ColumnName": "prohibition_reason"
                        },
                        "Value": "廃棄"
                      }
                    },
                    "Condition2": {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "CompareType": 1,
                      "ColumnBindingInfo": {
                        "TableName": "trn_insptool_tools",
                        "ColumnName": "prohibition_reason"
                      },
                      "Value": "故障"
                    }
                  },
                  "Condition2": {
                    "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                    "CompareType": 1,
                    "ColumnBindingInfo": {
                      "TableName": "trn_insptool_tools",
                      "ColumnName": "prohibition_reason"
                    },
                    "Value": "紛失"
                  }
                },
                "Condition2": {
                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                  "CompareType": 1,
                  "ColumnBindingInfo": {
                    "TableName": "trn_insptool_tools",
                    "ColumnName": "prohibition_reason"
                  },
                  "Value": "移管"
                }
              },
              "Condition2": {
                "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                "CompareType": 1,
                "ColumnBindingInfo": {
                  "TableName": "trn_insptool_tools",
                  "ColumnName": "prohibition_reason"
                },
                "Value": "不適合"
              }
            },
            "Condition2": {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 3,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "next_caribration_ymd"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=月初め"
              }
            }
          },
          "Condition2": {
            "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
            "CompareType": 5,
            "ColumnBindingInfo": {
              "TableName": "trn_insptool_tools",
              "ColumnName": "next_caribration_ymd"
            },
            "Value": {
              "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
              "SerializeProperty": "=月末"
            }
          }
        }
      },
      "ID": "a2ef06d671cf474997e04a39b1d56738"
    },
    {
      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
      "ConditionAndCommandPairList": [
        {
          "Condition": {
            "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
            "param": {
              "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
              "ParamObject": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=今月社内校正数"
              }
            },
            "value": "0",
            "compareType": 2
          },
          "CommandList": [
            {
              "$type": "Forguncy.Model.SendMailCommand, ServerDesignerCommon",
              "From": "equipment@rorze.com",
              "Subject": "社内校正機器について",
              "Content": "甲斐さま\r\n\r\nForguncyからの自動送信メールです。\r\n今月の社内校正対象測定機器は[=今月社内校正数]件あります。\r\n\r\n以上\r\n",
              "EnhancedRecipient": {
                "CommonValue": "murao.yuji@rorze.com"
              },
              "Priority": "high",
              "ID": "77bf274777894034876970994d851b6c"
            }
          ],
          "ID": "904a5438-d2a7-4dbb-a763-e978ea5ce374"
        }
      ]
    }
  ],
  "Name": "校正切れメール送信"
}