{
  "Name": "校正切れメール送信(R-プロジェクト)",
  "Description": "毎月一回\r\nR-プロジェクト(X)",
  "Enabled": true,
  "Triggers": [
    {
      "$type": "Forguncy.SaveLoad.MonthlyAndDaysOfMonthScheduleTriggerSaveData, ServerDesignerCommon",
      "DaysOfMonth": [
        1
      ],
      "Months": [
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9,
        10,
        11,
        12
      ],
      "StartDateTime": 45566.333333333336,
      "ScheduleRunInDebugServer": false
    }
  ],
  "Commands": [
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-1)+1,\"yyyy/m\")"
      },
      "ID": "4765ed634bb24a269ad9026b815d83fa"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月初日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-1)+1,\"yyyy/m/d\")"
      },
      "ID": "fd1728a168864ed9ba5b83d73a2a116f"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月末日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),0),\"yyyy/m/d\")"
      },
      "ID": "b2ced3ec71f142bf96e280f83cf56f2e"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "先月初日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-2)+1,\"yyyy/m/d\")"
      },
      "ID": "f4de8fc7a32f43008d2975e3ef6dec5c"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "先月末日",
      "ParameterValue": {
        "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
        "SerializeProperty": "=TEXT(EOMONTH(TODAY(),-1),\"yyyy/m/d\")"
      },
      "ID": "f1196e9b2396458187c8b6fee9fbb202"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月校正数",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "TableValueType": 3,
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "SubConditions": [
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 3,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "next_caribration_ymd",
                "GUID": "0b68bd3f-d38c-48a1-bbe9-1d39ecb9811b"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=今月初日"
              }
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 5,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "next_caribration_ymd",
                "GUID": "fffd5ccb-86c6-45d6-8dfa-ec6aa6295179"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=今月末日"
              }
            },
            {
              "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
              "SubConditions": [
                {
                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                  "ColumnBindingInfo": {
                    "TableName": "trn_insptool_tools",
                    "ColumnName": "category",
                    "GUID": "4c278b6c-b5d2-4a97-aaa1-d1159080a369"
                  },
                  "Value": "社内",
                  "LeftBracket": 1
                },
                {
                  "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                  "ColumnBindingInfo": {
                    "TableName": "trn_insptool_tools",
                    "ColumnName": "category",
                    "GUID": "acfe483f-38c2-468e-815b-ac67cce2e3c7"
                  },
                  "Value": "社外",
                  "RightBracket": 1
                }
              ],
              "RelationType": 1
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason",
                "GUID": "2ab2fbf0-807d-4ca6-8f98-cd4bc5c364e1"
              },
              "Value": "廃棄"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason",
                "GUID": "8887f942-10f0-4de6-baef-258fa0eb0a2d"
              },
              "Value": "故障"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason",
                "GUID": "b56b049d-ff6d-461e-941c-dd076dccaf88"
              },
              "Value": "紛失"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason",
                "GUID": "1d98b559-5006-49aa-b4e8-3ea36d409a7e"
              },
              "Value": "移管"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "prohibition_reason",
                "GUID": "d1a3d426-ac48-46eb-93f5-eef4d30768de"
              },
              "Value": "不適合"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "GUID": "c0781839-cbcb-40e3-85ad-3aaf2e46abbf",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "code"
                }
              },
              "Value": "X"
            }
          ]
        }
      },
      "ID": "ac80a740fa6647af9f2c26f725c735fc",
      "Comments": "校正月の案内用"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "今月期限数",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "TableValueType": 3,
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "SubConditions": [
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 3,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "kouseiyuukoukigenymd",
                "GUID": "27937029-ed8a-4a2b-aa53-3a4ea95b9fe3"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=今月初日"
              }
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 5,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "kouseiyuukoukigenymd",
                "GUID": "6dc3228e-b216-4aca-ab14-25f1855cb2d6"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=今月末日"
              }
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "GUID": "ac2c806f-ae08-4cbe-8a33-ab5ec6e92cc9",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "code"
                }
              },
              "Value": "X"
            }
          ]
        }
      },
      "ID": "f42db62159d543f6893f87079e20804c",
      "Comments": "有効期限が切れる案内"
    },
    {
      "$type": "Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",
      "ParameterName": "校正切れ数",
      "TableValue": {
        "TableName": "trn_insptool_tools",
        "TableValueType": 3,
        "SqlCondition": {
          "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
          "SubConditions": [
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 5,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "kouseiyuukoukigenymd",
                "GUID": "afa1bb94-2fe1-42d7-9127-008df0fbde0e"
              },
              "Value": {
                "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                "SerializeProperty": "=先月末日"
              }
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "usage",
                "GUID": "108e4edd-1282-41e4-9658-edf40a3cc8aa"
              },
              "Value": "使用禁止"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "CompareType": 1,
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "category",
                "GUID": "c27fd806-6866-47d2-97cf-0cfcc7bb4517"
              },
              "Value": "非校正"
            },
            {
              "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
              "ColumnBindingInfo": {
                "TableName": "trn_insptool_tools",
                "ColumnName": "n2",
                "GUID": "e41c2396-2e7b-41bf-8e8c-19b3ed68cddf",
                "RelationBinding": {
                  "RelatedTable": "mst_insptool_management_department",
                  "RelatedColumn": "code",
                  "DisplayColumn": "code"
                }
              },
              "Value": "X"
            }
          ]
        }
      },
      "ID": "aadcb78edc334a56a8f99c790e231f38",
      "Comments": "校正切れの案内用"
    },
    {
      "$type": "Forguncy.Model.ConditionCommand, ServerDesignerCommon",
      "ConditionAndCommandPairList": [
        {
          "Condition": {
            "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
            "SubConditions": [
              {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=今月校正数"
                  }
                },
                "value": "0",
                "compareType": 2
              },
              {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=今月期限数"
                  }
                },
                "value": "0",
                "compareType": 2
              },
              {
                "$type": "Forguncy.Model.IfCondition, ServerDesignerCommon",
                "param": {
                  "$type": "Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon",
                  "ParamObject": {
                    "$type": "Forguncy.Model.FormulaReferObject, ServerDesignerCommon",
                    "SerializeProperty": "=校正切れ数"
                  }
                },
                "value": "0",
                "compareType": 2
              }
            ],
            "RelationType": 1
          },
          "CommandList": [
            {
              "$type": "Forguncy.Model.SendMailCommand, ServerDesignerCommon",
              "From": "equipment@rorze.com",
              "EnhancedRecipient": {
                "TableName": "mst_insptool_personincharge",
                "TableColumn": {
                  "TableName": "mst_insptool_personincharge",
                  "ColumnName": "chart_in_person",
                  "GUID": "e5719833-8b5e-4b2b-9315-b3dbdb4bb397",
                  "AttachType": {
                    "$type": "ForguncyDataAccess.UserColumnAttachObj, ForguncyDataAccess",
                    "UserColumnAttachType": 2
                  }
                },
                "QueryCondition": {
                  "$type": "ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess",
                  "SubConditions": [
                    {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "mst_insptool_personincharge",
                        "ColumnName": "ctrl_id",
                        "GUID": "7bb833de-eb65-4ff9-8509-fdfe3511e9d5",
                        "RelationBinding": {
                          "RelatedTable": "mst_insptool_management_department",
                          "RelatedColumn": "ID",
                          "DisplayColumn": "code"
                        }
                      },
                      "Value": "X"
                    },
                    {
                      "$type": "ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess",
                      "ColumnBindingInfo": {
                        "TableName": "mst_insptool_personincharge",
                        "ColumnName": "contact",
                        "GUID": "6c220d72-cf1e-4a4f-86f1-c94790513878"
                      },
                      "Value": "1"
                    }
                  ]
                },
                "IsMultiRecipient": true
              },
              "Subject": "校正測定機器の期限について",
              "Content": "R-プロジェクト　担当者 さま\r\n\r\nForguncy計測機器タスクからの自動送信メールです。([=今月])\r\n①今月の校正対象測定機器は[=今月校正数]件あります。\r\n[%PageNavigate=(今月校正対象機器リスト,こちらをクリック)%]\r\n②今月の校正有効期限が切れる測定機器は[=今月期限数]件あります。\r\n[%PageNavigate=(今月校正有効期限機器リスト,こちらをクリック)%]\r\n③校正有効期限が切れた測定機器は[=校正切れ数]件あります。\r\n[%PageNavigate=(先月校正有効期限機器リスト,こちらをクリック)%]\r\n\r\n以上\r\n",
              "EnhancedBCC": {
                "CommonValue": "murao.yuji@rorze.com,qa-kousei@rorze.com"
              },
              "Priority": "high",
              "ID": "2910ce401dfe496a8e9a9b68551d2c6a"
            }
          ],
          "ID": "a2bc0809-ac2c-4038-b747-392a32c96ab5"
        }
      ]
    }
  ]
}